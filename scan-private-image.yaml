# Private Docker Image Security Scan
# Scan your private image: telesmartdevops/tsdm-backend:1.197.0

scan_request:
  description: "Security scan of private Docker image telesmartdevops/tsdm-backend:1.197.0"

# Scan Targets - your private image
targets:
  docker_images:
    - "telesmartdevops/tsdm-backend:1.197.0"
  git_repositories: []
  kubernetes_manifests: []
  terraform_code: []
  filesystem_paths: []

# Scanner Configuration - comprehensive container security
scanners:
  trivy:
    enabled: true
    timeout: 600
    severity_threshold: "HIGH"
    additional_args:
      - "--dependency-tree"
      - "--list-all-pkgs"
      - "--ignore-unfixed"

  grype:
    enabled: true
    timeout: 300
    severity_threshold: "MEDIUM"
    additional_args:
      - "--cache-dir=/tmp/grype-cache"
      - "--db-auto-update=false"
      - "--scope=squashed"
      - "--only-fixed"
      - "--by-cve"
      - "--show-suppressed=false"

  syft:
    enabled: true
    timeout: 300
    severity_threshold: "INFO"
    additional_args: []

  dockle:
    enabled: true
    timeout: 300
    severity_threshold: "MEDIUM"
    additional_args: []

  hadolint:
    enabled: true
    timeout: 300
    severity_threshold: "MEDIUM"
    additional_args: []

  # Disable non-container scanners
  semgrep:
    enabled: false
  trufflehog:
    enabled: false
  gitleaks:
    enabled: false
  checkov:
    enabled: false
  conftest:
    enabled: false

# Output Configuration
output:
  base_dir: "security-reports"
  formats:
    - "json"
    - "html"
    - "sarif"
  include_raw: true
  generate_executive_summary: true

# Execution Settings
execution:
  parallel_scans: true
  max_workers: 4
  fail_on_high_severity: false

# Logging Configuration
logging:
  level: "INFO"
  file: "private-image-scan.log"