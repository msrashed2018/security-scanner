# Secrets Detection Scan Template
# Focused exclusively on finding secrets and sensitive data

scan_request:
  description: "Secrets detection scan for sensitive data"

# Scan Targets - can scan any target type for secrets
targets:
  docker_images: []
  git_repositories: ["."]
  kubernetes_manifests: []
  terraform_code: []
  filesystem_paths: []

# Scanner Configuration - secrets detection only
scanners:
  trufflehog:
    enabled: true
    timeout: 900
    severity_threshold: "HIGH"
    additional_args:
      - "--no-verification"
      - "--filter-entropy=3.0"
      - "--concurrency=6"
      - "--only-verified=false"
  
  gitleaks:
    enabled: true
    timeout: 600
    severity_threshold: "HIGH"
    additional_args:
      - "--verbose"
  
  # Disable all other scanners
  trivy:
    enabled: false
  grype:
    enabled: false
  syft:
    enabled: false
  dockle:
    enabled: false
  hadolint:
    enabled: false
  checkov:
    enabled: false
  conftest:
    enabled: false
  semgrep:
    enabled: false

# Output Configuration
output:
  base_dir: "secrets-scan-reports"
  formats:
    - "json"
    - "html"
  include_raw: false  # Raw output may contain actual secrets
  generate_executive_summary: true

# Execution Settings
execution:
  parallel_scans: true
  max_workers: 2
  fail_on_high_severity: true  # Always fail on secrets found

# Logging Configuration
logging:
  level: "WARNING"  # Reduce logging to avoid secrets in logs
  file: "secrets-scan.log"

# Metadata
metadata:
  scan_type: "secrets-detection"
  compliance: ["pci-dss", "hipaa", "sox"]